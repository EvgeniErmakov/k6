Техническое задание (ТЗ)

на реализацию проекта нагрузочного тестирования с использованием k6, Elasticsearch, Grafana и Kibana

1. Общие сведения

Наименование проекта:
Система для проведения нагрузочного тестирования и визуализации результатов.

Цель проекта:
Разработать локальное решение для проведения нагрузочного тестирования (НТ) сервисов с помощью фреймворка k6, обеспечив сбор, хранение и визуализацию метрик в реальном времени через Elasticsearch, Grafana и при необходимости Kibana для отладки и анализа данных.

2. Цели и задачи проекта
2.1. Цель

Обеспечить возможность:

запуска нагрузочных тестов локально;

автоматической передачи метрик из k6 в Elasticsearch;

визуализации показателей тестов в Grafana;

отладки и анализа данных индексации через Kibana.

2.2. Основные задачи

Реализовать архитектуру взаимодействия k6 → Elasticsearch → Grafana (+ опционально Kibana).

Настроить локальное окружение с помощью Docker Compose.

Обеспечить запись данных в Elasticsearch и визуализацию через Grafana.

Предусмотреть возможность анализа данных и диагностики индексов через Kibana.

Подготовить структуру проекта и файл-инструкцию (README.md) по запуску и настройке.

4. Требования к функциональности
4.1. Общие требования

Все сервисы должны быть развёрнуты в контейнерах Docker.

Запуск системы выполняется одной командой:

docker-compose up -d


После запуска сервисы доступны локально:

Elasticsearch: http://localhost:9200

Grafana: http://localhost:3000

Kibana: http://localhost:5601

k6 должен иметь возможность записывать результаты тестов в Elasticsearch:

k6 run --out elasticsearch=http://localhost:9200/k6-metrics ./tests/load_test.js

4.2. Контейнеры и версии
Сервис	Версия	Порт	Примечание
Elasticsearch	8.x	9200	Одиночный узел
Grafana	LTS (актуальная)	3000	Визуализация метрик
Kibana	8.x	5601	Диагностика и анализ индексов
k6	Последняя стабильная	CLI / контейнер	Генерация нагрузки
5. Настройка интеграций
5.1. k6 → Elasticsearch

Используется встроенный output-драйвер:
--out elasticsearch=http://localhost:9200/k6-metrics

Индекс для метрик: k6-metrics

Формат хранения: JSON-документы с метриками (vus, http_reqs, duration, http_req_failed и др.)

Метаданные должны содержать метку времени (@timestamp).

5.2. Grafana → Elasticsearch

После запуска Grafana пользователь вручную добавляет источник данных:

Type: Elasticsearch

URL: http://elasticsearch:9200

Index name: k6-metrics*

Time field: @timestamp

Настраиваются визуализации:

Requests per Second (RPS)

Среднее время отклика

Количество неуспешных запросов

Количество активных пользователей (VUs)

Пиковая нагрузка

5.3. Kibana → Elasticsearch

Kibana автоматически подключается к Elasticsearch при старте (по адресу http://elasticsearch:9200).

Предоставляет возможности:

Просмотра и фильтрации “сырых” метрик;

Проверки структуры индексов (k6-metrics*);

Отладки корректности индексирования и типов полей;

Быстрого анализа неагрегированных данных перед визуализацией в Grafana.

6. Требования к инфраструктуре проекта
6.1. Структура проекта
project/
├── docker-compose.yml
├── tests/
│   └── load_test.js
├── grafana/
│   └── provisioning/        # (опционально) автоимпорт источников и дашбордов
├── elasticsearch/
│   └── config/
├── kibana/
│   └── config/
├── .env
└── README.md                # инструкция по запуску и настройке

6.2. Docker Compose

Все контейнеры описываются в docker-compose.yml.

Сервисы связаны в общей сети Docker (bridge).

Для Elasticsearch, Grafana и Kibana создаются тома для сохранения данных. Имя вольюмов должно быть понятное, данные после остановки сервисов не должны потеряться.

7. Файл-инструкция (README.md)

В проекте обязательно присутствует файл README.md, содержащий:

Краткое описание проекта и его назначения.

Пошаговую инструкцию по развертыванию окружения.

Данные для доступа к сервисам (порты, логины/пароли).

Команды для запуска нагрузочного теста.

Порядок подключения Grafana к Elasticsearch.

Порядок проверки данных через Kibana.

Пример настройки дашбордов.

Наименование вольюмов.